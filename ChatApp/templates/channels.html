{# アプリ動作確認用 #}
{% extends 'base.html' %} {% block title %}
<title>Channels</title>
{% endblock %}
{% block body %}
<div class="container">
  <div class="channels-header">
    <h1>Channels</h1>
    <form method="POST" action="{{url_for('logout')}}" class="logout-form">
      <button type="submit" class="secondary">ログアウト</button>
    </form>
  </div>
  {% with messages = get_flashed_messages() %}{% if messages %}
  <div class="flash-messages">
  <ul>
      {% for message in messages %}
      <li>{{ message }}</li>
      {% endfor %}
  </ul>
  </div>
  {% endif %}{% endwith %}

  <ul class="channels-list">
  {% for channel in channels %}
  <li class="channel-item">
      <a href="{{ url_for('messages_view', cid=channel.id)}}">{{ channel.name }}</a>
      <p>{{ channel.description }}</p>
      <div class="channel-actions">
      {% if channel.user_id == uid %}
          <form class="channel-edit" method="POST" action="{{url_for('channel_action', cid=channel.id)}}">
              <input type="hidden" name="_method" value="PUT">
              <input type="text" name="channelName" placeholder="新しい名前" required>
              <input type="text" name="channelDescription" placeholder="説明">
              <button type="submit">編集</button>
          </form>
          <form class="channel-delete" method="POST" action="{{url_for('channel_action', cid=channel.id)}}">
              <input type="hidden" name="_method" value="DELETE">
              <button type="submit" class="secondary">削除</button>
          </form>
      {% endif %}
      </div>
  </li>
  {% endfor %}
  </ul>

  <form method="POST" action="{{url_for('create_channel')}}" class="create-channel">
      <input type="text" name="channelName" placeholder="チャンネル名" required>
      <input type="text" name="channelDescription" placeholder="説明（任意）">
      <button type="submit">チャンネル作成</button>
  </form>

</div>
{% endblock %}
