{# アプリ動作確認用 #}
{% extends 'base.html' %}
{% block extra_head %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/messages.css') }}">
{% endblock %}
{% block title %}
<title>home</title>
{% endblock %}
{% block body %}
<h1>{{ channel.name}}のメッセージ一覧</h1>
<!-- top-right action buttons (Channels / Logout) -->
<div class="top-right-actions">
  <form class="channels-topright" method="GET" action="{{ url_for('channels_view') }}">
    <button type="submit">チャンネル一覧に戻る</button>
  </form>
  <form class="logout-topright" method="POST" action="{{ url_for('logout') }}">
    <button type="submit">ログアウト</button>
  </form>
</div>
<p>{{ channel.description}}</p>
{% with messages = get_flashed_messages() %}{% if messages %}
<ul>
    {% for message in messages %}
    <li>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}{% endwith %}
<ul>
<ul id="messages">
{% for message in messages %}
  <li class="message {% if message.user_id != uid %}left{% else %}right{% endif %}">
    {{ message.name }}：{{ message.message }}
    {% if message.user_id == uid %}
      <form method="POST" action="{{ url_for('message_action', cid=channel.id, mid=message.id) }}">
        <input type="hidden" name="_method" value="PUT">
        <input type="text" name="message" placeholder="編集内容" required>
        <button type="submit">編集</button>
      </form>

      <form method="POST" action="{{ url_for('message_action', cid=channel.id, mid=message.id) }}">
        <input type="hidden" name="_method" value="DELETE">
        <button type="submit">削除</button>
      </form>
    {% endif %}
  </li>
{% endfor %}
</ul>

<!-- fixed chat form at bottom center -->
<form id="chat-form" method="POST" action="{{ url_for('create_message', cid=channel.id) }}">
  <input id="message-input" type="text" name="message" placeholder="メッセージを入力" required>
  <button id="send-message" type="submit">投稿</button>
</form>
{# channel list navigation moved to top-right #}
{# bottom logout removed — top-right logout is added above the header #}
{% endblock %}
