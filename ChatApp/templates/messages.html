{# アプリ動作確認用 #}
{% extends 'base.html' %} {% block title %}
<title>home</title>
{% endblock %} {% block body %}
<h1>{{ channel.name}}のメッセージ一覧</h1>
<p>{{ channel.description}}</p>
{% with messages = get_flashed_messages() %}{% if messages %}
<ul>
    {% for message in messages %}
    <li>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}{% endwith %}
<ul>
{% for message in messages %}
  <li>
    {{ message.name }}：{{ message.message }}
    {% if message.user_id == uid %}
      <form method="POST" action="{{ url_for('message_action', cid=channel.id, mid=message.id) }}">
        <input type="hidden" name="_method" value="PUT">
        <input type="text" name="message" placeholder="編集内容" required>
        <button type="submit">編集</button>
      </form>

      <form method="POST" action="{{ url_for('message_action', cid=channel.id, mid=message.id) }}">
        <input type="hidden" name="_method" value="DELETE">
        <button type="submit">削除</button>
      </form>
    {% endif %}
  </li>
{% endfor %}
</ul>
<form method="POST" action="{{ url_for('create_message', cid=channel.id) }}">
    <input type="text" name="message" placeholder="メッセージを入力" required>
    <button type="submit">投稿</button>
</form>
<form method="GET" action="{{ url_for('channels_view') }}">
  <button type="submit">チャンネル一覧に戻る</button>
</form>
{# ログアウトは後々POSTに変更 #}
<form method="GET" action="{{ url_for('logout') }}">
  <button type="submit">ログアウト</button>
</form>
{% endblock %}
